# 機能要件定義

## 1. ユーザー管理

### 1.1 ユーザー登録

- **機能**: 新規ユーザーがアカウントを作成できる
- **入力項目**:
    - メールアドレス（必須、一意）
    - パスワード（必須、8文字以上）
    - 表示名（必須）
- **検証**:
    - メールアドレス形式の検証
    - パスワード強度の検証
    - 重複メールアドレスの検証

### 1.2 ユーザーログイン

- **機能**: 登録済みユーザーがシステムにログインできる
- **認証方式**: メールアドレス + パスワード
- **セッション管理**: セキュアなセッション管理

### 1.3 ユーザープロフィール管理

- **機能**: ユーザーが自身のプロフィールを編集できる
- **編集可能項目**: 表示名、パスワード

## 2. チーム管理

### 2.1 チーム作成

- **機能**: ユーザーがチームを作成できる
- **入力項目**:
    - チーム名（必須）
    - チーム説明（任意）
- **権限**: チーム作成者は自動的にチーム管理者になる

### 2.2 チーム編集

- **機能**: チーム管理者がチーム情報を編集できる
- **編集可能項目**: チーム名、チーム説明
- **権限**: チーム管理者のみ

### 2.3 チーム削除

- **機能**: チーム管理者がチームを削除できる
- **権限**: チーム管理者のみ
- **制約**: チームに所属メンバーがいる場合は削除不可

## 3. チームメンバー管理

### 3.1 メンバー招待

- **機能**: チーム管理者が新しいメンバーをチームに招待できる
- **招待方式**: メールアドレスによる招待
- **権限**: チーム管理者のみ

### 3.2 メンバー承認

- **機能**: 招待されたユーザーがチーム参加を承認できる
- **通知**: 招待メールの送信

### 3.3 メンバー削除

- **機能**: チーム管理者がメンバーをチームから削除できる
- **権限**: チーム管理者のみ
- **制約**: 自分自身は削除不可

## 4. 役割管理

### 4.1 役割定義

- **デフォルト役割**:
    - 管理者: すべての操作が可能
    - メンバー: 自身のOKRの作成・編集、他メンバーのOKR閲覧
    - 閲覧者: OKRの閲覧のみ

### 4.2 役割割り当て

- **機能**: チーム管理者がメンバーに役割を割り当てられる
- **権限**: チーム管理者のみ
- **制約**: 少なくとも1人の管理者が必要

### 4.3 権限管理

- **OKR作成・編集**: 管理者、メンバー
- **OKR削除**: 管理者のみ
- **他メンバーのOKR閲覧**: すべての役割
- **チーム管理**: 管理者のみ

## 5. OKR管理

### 5.1 OKRの構造

- **Objective（目標）**:
    - タイトル（必須）
    - 説明（任意）
    - 期間（四半期ベース）
- **Key Result（成果指標）**:
    - タイトル（必須）
    - 目標値（必須、数値）
    - 現在値（初期値0）
    - 単位（任意）

### 5.2 チームOKR管理

- **機能**: チーム管理者がチーム全体のOKRを作成・管理できる
- **作成権限**: チーム管理者のみ
- **閲覧権限**: すべてのチームメンバー

### 5.3 個人OKR管理

- **機能**: メンバーが個人のOKRを作成・管理できる
- **作成権限**: 管理者、メンバー
- **編集権限**: 作成者本人、チーム管理者
- **閲覧権限**: すべてのチームメンバー

### 5.4 OKR進捗更新

- **機能**: Key Resultの現在値を更新できる
- **更新権限**: 作成者本人、チーム管理者
- **履歴管理**: 更新履歴を記録

## 6. レビュー管理

### 6.1 中間レビュー

- **機能**: OKRの進捗を定期的にレビューできる
- **レビュー項目**:
    - Key Resultの進捗状況
    - 課題・障害
    - 次のアクションプラン
- **レビュー権限**: 作成者本人、チーム管理者

### 6.2 レビュー頻度設定

- **設定可能頻度**:
    - 週次
    - 隔週
    - 月次
- **設定権限**: チーム管理者
- **適用範囲**: チーム単位

### 6.3 最終レビュー

- **機能**: 四半期終了時にOKRの最終評価を行う
- **評価項目**:
    - Key Resultの達成率
    - 全体的な評価・振り返り
    - 次四半期への改善点
- **評価権限**: 作成者本人、チーム管理者

## 7. データ要件

### 7.1 データ保持期間

- OKRデータ: 無期限保持
- レビューデータ: 無期限保持
- ユーザーセッション: 30日間

### 7.2 データ整合性

- 外部キー制約の維持
- トランザクション処理による一貫性保証

### 7.3 データ検索

- OKRのタイトル・説明での検索
- 期間での絞り込み
- メンバーでの絞り込み
